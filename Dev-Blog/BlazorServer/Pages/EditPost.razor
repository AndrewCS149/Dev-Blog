@page "/editpost/{Id}"

@inject IPosts _posts
@inject NavigationManager NavMgr

<h3>EditPost</h3>

@if (post == null)
{
    <p>Loading...</p>
}
else
{
    <EditForm Model=@post OnValidSubmit=@UpdatePost>
        <DataAnnotationsValidator />
        <ValidationSummary />

        <InputTextArea @bind-Value=post.Description />
        <InputText @bind-Value=post.UpdateNum />
        <button type="submit">Update</button>
    </EditForm>
}

@code {
    [Parameter]
    public String Id { get; set; }
    private PostModel post;

    protected override async Task OnInitializedAsync()
    {
        post = await _posts.GetPost(int.Parse(Id));
    }

    private async Task UpdatePost()
    {
        await _posts.UpdatePost(post);
        NavMgr.NavigateTo("/posts");
    }
}